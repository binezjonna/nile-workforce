<script>
    // =========== Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ===========
    const STORAGE_KEY = 'nileWorkForce_applications';
    const ADMIN_PASSWORD = 'admin123';
    const PHONE_NUMBER = '01028052445';
    const WHATSAPP_NUMBER = '201028052445';
    const GOOGLE_SCRIPT_URL = 'Ø¶Ø¹_Ø±Ø§Ø¨Ø·_Google_Script_Ù‡Ù†Ø§'; // Ø¶Ø¹ Ø±Ø§Ø¨Ø·Ùƒ Ù‡Ù†Ø§
    
    // =========== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… ===========
    document.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸš€ Ù†Ø¸Ø§Ù… Nile Work Force ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­');
       
        // ØªÙØ¹ÙŠÙ„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
        document.getElementById('fileUploadArea').addEventListener('click', function() {
            document.getElementById('cv').click();
        });
       
        document.getElementById('cv').addEventListener('change', handleFileUpload);
       
        // Ø²Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        document.getElementById('adminToggle').addEventListener('click', showAdminDashboard);
       
        // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø³Ù„Ø³
        setupSmoothScroll();
       
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        updateStats();
    });
    
    // =========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª ===========
    function handleFileUpload(e) {
        const file = e.target.files[0];
        const uploadText = document.getElementById('fileUploadText');
        const fileName = document.getElementById('fileName');
        const uploadArea = document.getElementById('fileUploadArea');
       
        if (file) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (5MB ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)
            if (file.size > 5 * 1024 * 1024) {
                showMessage('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ Ù‡Ùˆ 5MB.', 'error');
                e.target.value = '';
                uploadText.textContent = 'Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©';
                fileName.textContent = '';
                uploadArea.style.borderColor = '#ddd';
                uploadArea.style.background = '#f9f9f9';
                return;
            }
           
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
            const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            if (!allowedTypes.includes(file.type)) {
                showMessage('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£Ùˆ Word ÙÙ‚Ø·.', 'error');
                e.target.value = '';
                uploadText.textContent = 'Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©';
                fileName.textContent = '';
                uploadArea.style.borderColor = '#ddd';
                uploadArea.style.background = '#f9f9f9';
                return;
            }
           
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            uploadText.textContent = 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù';
            fileName.innerHTML = `<i class="fas fa-check-circle"></i> ${file.name} (${formatFileSize(file.size)})`;
            uploadArea.style.borderColor = '#28a745';
            uploadArea.style.background = '#f0fff4';
        }
    }
    
    // =========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… ===========
    document.getElementById('jobApplicationForm').addEventListener('submit', async function(e) {
        e.preventDefault();
       
        // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const cvFile = document.getElementById('cv').files[0];
        const fullName = document.getElementById('fullName').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const email = document.getElementById('email').value.trim();
       
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        if (!fullName || !phone || !email) {
            showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
            return;
        }
       
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            showMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­', 'error');
            return;
        }
       
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
        const phoneRegex = /^01[0-2,5]{1}[0-9]{8}$/;
        if (!phoneRegex.test(phone)) {
            showMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØµØ±ÙŠ ØµØ­ÙŠØ­ (Ù…Ø«Ø§Ù„: 01028052445)', 'error');
            return;
        }
       
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
        if (!cvFile) {
            showMessage('ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©', 'error');
            return;
        }
       
        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù ÙƒÙ€ base64
        const reader = new FileReader();
        
        reader.onload = async function(e) {
            // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ø·Ù„Ø¨
            const application = {
                id: 'NWF-' + Date.now().toString().slice(-8),
                name: fullName,
                phone: phone,
                email: email,
                governorate: document.getElementById('governorate').value,
                sector: document.getElementById('sector').value,
                experience: document.getElementById('experience').value,
                cvFile: {
                    name: cvFile.name,
                    size: cvFile.size,
                    type: cvFile.type,
                    data: e.target.result
                },
                message: document.getElementById('message').value.trim() || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯',
                date: new Date().toLocaleString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }),
                timestamp: Date.now(),
                status: 'Ø¬Ø¯ÙŠØ¯'
            };
           
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ÙØ¸ ÙÙŠ Google Sheets
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(application)
                });
                
                // Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ ÙƒÙ†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                saveLocalApplication(application);
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                showSuccessMessage(application);
                
                // Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¹Ø¯ 8 Ø«ÙˆØ§Ù†
                setTimeout(() => {
                    resetForm();
                    document.getElementById('formMessage').style.display = 'none';
                }, 8000);
                
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                // Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„
                saveLocalApplication(application);
                showSuccessMessage(application);
            }
        };
       
        reader.onerror = function() {
            showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
        };
       
        reader.readAsDataURL(cvFile);
    });
    
    // =========== Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ ===========
    function saveLocalApplication(application) {
        const applications = getLocalApplications();
        applications.unshift(application);
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(applications));
            updateStats();
            console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:', application.name);
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        }
    }
    
    function getLocalApplications() {
        try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            return [];
        }
    }
    
    // =========== Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ ===========
    function showSuccessMessage(application) {
        const refNumber = application.id;
        showMessage(`
            <div style="text-align: center;">
                <i class="fas fa-check-circle" style="font-size: 3.5rem; color: #28a745; margin-bottom: 20px;"></i>
                <h3 style="color: #155724; margin-bottom: 15px;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p style="margin-bottom: 10px;">Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹: <strong style="color: var(--primary);">${refNumber}</strong></p>
                <p style="margin-bottom: 10px;">Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ <strong style="color: var(--secondary);">${application.name}</strong> Ø¹Ù„Ù‰ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨Ùƒ.</p>
                <p style="margin-bottom: 15px;">Ø³Ø£ØªØµÙ„ Ø¨Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… <strong style="color: var(--secondary);">${application.phone}</strong> Ø®Ù„Ø§Ù„ 24-48 Ø³Ø§Ø¹Ø©.</p>
                <p style="font-size: 0.9rem; color: #666;">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø§Ù„ÙÙˆØ±ÙŠ: <strong style="color: var(--primary);">${PHONE_NUMBER}</strong></p>
            </div>
        `, 'success');
    }
    
    // =========== Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ===========
    function resetForm() {
        document.getElementById('jobApplicationForm').reset();
        document.getElementById('fileUploadText').textContent = 'Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©';
        document.getElementById('fileName').textContent = '';
        document.getElementById('fileUploadArea').style.borderColor = '#ddd';
        document.getElementById('fileUploadArea').style.background = '#f9f9f9';
    }
    
    // =========== Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ===========
    async function showAdminDashboard() {
        const password = prompt('ğŸ”’ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:');
        if (password === ADMIN_PASSWORD) {
            const dashboard = document.getElementById('dashboard');
            dashboard.style.display = 'block';
            await loadDashboard();
            dashboard.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else if (password !== null) {
            alert('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
        }
    }
    
    async function loadDashboard() {
        try {
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets
            const response = await fetch(GOOGLE_SCRIPT_URL);
            const result = await response.json();
            
            let applications = [];
            
            if (result.success && result.data) {
                applications = result.data.map(app => ({
                    id: app.id || '',
                    name: app.name || '',
                    phone: app.phone || '',
                    email: app.email || '',
                    governorate: app.governorate || '',
                    sector: app.sector || '',
                    experience: app.experience || '',
                    cvFile: {
                        name: app['cv file name'] || '',
                        size: 0,
                        data: ''
                    },
                    message: app.message || '',
                    date: app.date || '',
                    status: 'Ø¬Ø¯ÙŠØ¯'
                }));
            } else {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„
                applications = getLocalApplications();
            }
           
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
            document.getElementById('applicationsCount').textContent = `${applications.length} Ø·Ù„Ø¨Ø§Øª ØªÙˆØ¸ÙŠÙ`;
           
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            updateDashboardStats(applications);
           
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
            updateApplicationsTable(applications);
           
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
            document.getElementById('lastUpdate').textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })}`;
        } catch (error) {
            console.error('Error loading dashboard:', error);
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
            const applications = getLocalApplications();
            loadDashboardData(applications);
        }
    }
    
    function loadDashboardData(applications) {
        document.getElementById('applicationsCount').textContent = `${applications.length} Ø·Ù„Ø¨Ø§Øª ØªÙˆØ¸ÙŠÙ`;
        updateDashboardStats(applications);
        updateApplicationsTable(applications);
        document.getElementById('lastUpdate').textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleString('ar-EG', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        })}`;
    }
    
    function updateDashboardStats(applications) {
        const today = new Date().toDateString();
        const todayApps = applications.filter(app => {
            const appDate = new Date(app.date).toDateString();
            return appDate === today;
        }).length;
       
        const hotelApps = applications.filter(app => app.sector && app.sector.includes('ÙÙ†Ø§Ø¯Ù‚')).length;
        const factoryApps = applications.filter(app => app.sector && app.sector.includes('Ù…ØµØ§Ù†Ø¹')).length;
        const companyApps = applications.filter(app => app.sector && (app.sector.includes('Ø´Ø±ÙƒØ§Øª') || app.sector.includes('Ù…Ø¤Ø³Ø³Ø§Øª'))).length;
       
        const statsHTML = `
            <div class="dashboard-stat">
                <h3>${applications.length}</h3>
                <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
            </div>
            <div class="dashboard-stat">
                <h3>${todayApps}</h3>
                <p>Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
            </div>
            <div class="dashboard-stat">
                <h3>${hotelApps}</h3>
                <p>Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙÙ†Ø§Ø¯Ù‚</p>
            </div>
            <div class="dashboard-stat">
                <h3>${factoryApps}</h3>
                <p>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµØ§Ù†Ø¹</p>
            </div>
            <div class="dashboard-stat">
                <h3>${companyApps}</h3>
                <p>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ§Øª</p>
            </div>
        `;
       
        document.getElementById('dashboardStats').innerHTML = statsHTML;
    }
    
    function updateApplicationsTable(applications) {
        const tbody = document.getElementById('applicationsBody');
       
        if (applications.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="8" style="text-align: center; padding: 50px; color: var(--gray);">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 20px; display: block; opacity: 0.5;"></i>
                        <h3 style="color: var(--gray); margin-bottom: 15px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª ØªÙˆØ¸ÙŠÙ Ø¨Ø¹Ø¯</h3>
                        <p style="color: var(--gray);">Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¬Ù…ÙŠØ¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ Ø§Ù„ØªÙŠ ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ…Ù‡Ø§</p>
                    </td>
                </tr>
            `;
            return;
        }
       
        let html = '';
        applications.forEach((app, index) => {
            html += `
                <tr>
                    <td style="font-weight: 700; color: var(--primary);">${index + 1}</td>
                    <td>
                        <strong style="color: var(--primary);">${app.name}</strong><br>
                        <small style="color: var(--gray);">${app.email}</small>
                    </td>
                    <td style="direction: ltr; text-align: left;">${app.phone}</td>
                    <td><span style="background: #e8f0fe; color: var(--primary); padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">${app.governorate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span></td>
                    <td><span style="background: #f0f4ff; color: var(--secondary); padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">${app.sector || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span></td>
                    <td>${app.experience || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td><small style="color: var(--gray);">${app.date || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</small></td>
                    <td>
                        <div class="action-btns">
                            <button class="btn" onclick="viewApplication('${app.id}')" style="background: var(--primary); color: white; padding: 8px 12px; font-size: 0.9rem;">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${app.cvFile && app.cvFile.data ? `
                            <button class="btn" onclick="downloadCV('${app.id}')" style="background: var(--accent); color: white; padding: 8px 12px; font-size: 0.9rem;" title="ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©">
                                <i class="fas fa-download"></i>
                            </button>
                            ` : ''}
                            <button class="btn" onclick="contactApplicant('${app.phone}', '${app.name}')" style="background: #25D366; color: white; padding: 8px 12px; font-size: 0.9rem;">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                            <button class="btn" onclick="deleteApplication('${app.id}')" style="background: var(--danger); color: white; padding: 8px 12px; font-size: 0.9rem;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        });
       
        tbody.innerHTML = html;
    }
    
    // =========== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ===========
    function showMessage(content, type) {
        const messageDiv = document.getElementById('formMessage');
        messageDiv.className = `message ${type}`;
        messageDiv.innerHTML = content;
        messageDiv.style.display = 'block';
        messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function formatFileSize(bytes) {
        if (bytes < 1024) return bytes + ' Ø¨Ø§ÙŠØª';
        else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª';
        else return (bytes / 1048576).toFixed(1) + ' Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª';
    }
    
    function updateStats() {
        const applications = getLocalApplications();
       
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        const hotelApps = applications.filter(app => app.sector && app.sector.includes('ÙÙ†Ø¯Ù‚')).length;
        const factoryApps = applications.filter(app => app.sector && app.sector.includes('Ù…ØµÙ†Ø¹')).length;
       
        document.getElementById('statHotels').textContent = `${Math.max(50, hotelApps * 5)}+`;
        document.getElementById('statFactories').textContent = `${Math.max(30, factoryApps * 3)}+`;
        document.getElementById('statApplicants').textContent = `${applications.length}+`;
       
        const uniqueGovernorates = new Set(applications.map(app => app.governorate));
        document.getElementById('statGovernorates').textContent = Math.max(15, uniqueGovernorates.size);
    }
    
    function setupSmoothScroll() {
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
               
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    const headerHeight = document.querySelector('header').offsetHeight;
                    window.scrollTo({
                        top: targetElement.offsetTop - headerHeight - 20,
                        behavior: 'smooth'
                    });
                }
            });
        });
    }
    
    // =========== Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… ===========
    console.log('ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:', PHONE_NUMBER);
    console.log('ğŸ”‘ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:', ADMIN_PASSWORD);
    console.log('ğŸ’¾ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ†:', STORAGE_KEY);
    console.log('ğŸŒ Ø±Ø§Ø¨Ø· Google Script:', GOOGLE_SCRIPT_URL);
    console.log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… - Ù…Ø¯ÙŠØ± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©');
</script>
