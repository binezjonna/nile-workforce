<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nile Work Force - Updated</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link id="bootstrap-css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans Arabic', 'Arial', sans-serif; background-color: #f8f9fa; }
        .hero { background: linear-gradient(90deg, #007bff, #00bfff); color: white; padding: 80px 0; text-align: center; }
        .job-card { margin-bottom: 20px; }
        section { padding: 40px 0; }
        .form-control { margin-bottom: 12px; }
        footer { background: #007bff; color: white; padding: 20px; text-align: center; }
        #adminNavButton { position: fixed; bottom: 16px; left: 16px; z-index: 2000; }
        .hidden { display: none !important; }
        .small-muted { font-size: 0.85rem; color: #6c757d; }
    </style>

    <!-- Firebase compat SDKs (uses compat so old-style code works) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
</head>
<body dir="rtl">
    <header class="bg-light py-3">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-light">
                <a class="navbar-brand" href="#">Ù‚ÙˆØ© Ø¹Ù…Ù„ Ø§Ù„Ù†ÙŠÙ„</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto" id="mainNav">
                        <li class="nav-item"><a class="nav-link" onclick="showSection('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                        <li class="nav-item"><a class="nav-link" onclick="showSection('jobs')">Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</a></li>
                        <li class="nav-item"><a class="nav-link" onclick="showSection('apply')">Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</a></li>
                        <li class="nav-item hidden" id="adminNav"><a class="nav-link" onclick="showSection('admin')">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a></li>
                        <li class="nav-item"><a class="nav-link" onclick="changeLanguage('en')">English</a></li>
                        <li class="nav-item"><a class="nav-link" onclick="changeLanguage('ar')">Ø¹Ø±Ø¨ÙŠ</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <section id="home" class="hero">
        <div class="container">
            <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù‚ÙˆØ© Ø¹Ù…Ù„ Ø§Ù„Ù†ÙŠÙ„</h1>
            <p>Ø¨ÙˆØ§Ø¨ØªÙƒ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù„ÙˆØ¸Ø§Ø¦Ù ÙÙŠ ÙÙ†Ø§Ø¯Ù‚ Ù…ØµØ± ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø¹Ø§Øª ÙˆØ§Ù„Ø´Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…ØµØ§Ù†Ø¹. Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø¨Ø§Ø­Ø«ÙŠÙ† Ø¹Ù† Ø¹Ù…Ù„!</p>
            <button class="btn btn-light" onclick="showSection('jobs')">ØªØµÙØ­ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</button>
        </div>
    </section>

    <section id="jobs">
        <div class="container">
            <h2>Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ù…ØµØ±</h2>
            <div class="row" id="jobsList">
                <!-- job cards will be dynamically loaded if needed -->
            </div>
        </div>
    </section>

    <section id="apply" class="hidden">
        <div class="container">
            <h2>Ø§Ù„ØªÙ‚Ø¯Ù… Ù„ÙˆØ¸ÙŠÙØ©</h2>
            <form id="applicationForm">
                <input type="text" id="name" class="form-control" placeholder="Ø§Ù„Ø§Ø³Ù…" required>
                <input type="email" id="email" class="form-control" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
                <input type="tel" id="phone" class="form-control" placeholder="Ø§Ù„Ù‡Ø§ØªÙ">

                <!-- Allow either resume link or file upload. File upload preferred. -->
                <label class="small-muted">Ø§Ø±ÙÙ‚ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© (Ù…Ù„Ù PDF Ø£Ùˆ DOC Ø£Ùˆ Ø±Ø§Ø¨Ø·)</label>
                <input type="file" id="resumeFile" class="form-control" accept=".pdf,.doc,.docx">
                <input type="url" id="resumeLink" class="form-control" placeholder="Ø£Ùˆ Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">

                <input type="text" id="job" class="form-control" placeholder="Ø§Ù„ØªÙ‚Ø¯Ù… Ù„Ù€" required>
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">Ø¥Ø±Ø³Ø§Ù„</button>
                    <button type="button" class="btn btn-secondary" id="clearForm">Ù…Ø³Ø­</button>
                </div>
                <div id="uploadStatus" class="small-muted mt-2"></div>
            </form>
        </div>
    </section>

    <section id="admin" class="hidden">
        <div class="container">
            <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>

            <div id="loginForm">
                <input type="email" id="adminEmail" class="form-control" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ" required>
                <input type="password" id="adminPassword" class="form-control" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                <button onclick="adminLogin()" class="btn btn-primary">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </div>

            <div id="applicantsPanel" class="hidden mt-3">
                <div class="d-flex justify-content-between mb-2">
                    <div>
                        <button class="btn btn-success" onclick="exportCSV()">ØªØµØ¯ÙŠØ± CSV</button>
                        <label class="btn btn-outline-primary mb-0">
                            Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV <input type="file" id="importCsv" accept=".csv" hidden onchange="importCSVFile(event)">
                        </label>
                    </div>
                    <button class="btn btn-secondary" onclick="adminLogout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                </div>

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                            <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                            <th>Ø§Ù„Ø³ÙŠØ±Ø©</th>
                            <th>Ø§Ù„ÙˆØ¸ÙŠÙØ©</th>
                            <th>ÙˆÙ‚Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</th>
                        </tr>
                    </thead>
                    <tbody id="applicantsTableBody"></tbody>
                </table>
            </div>
        </div>
    </section>

    <button id="adminNavButton" class="btn btn-dark" onclick="unlockAdmin()">ğŸ”’ Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø®Ø§Øµ)</button>

    <footer>
        <p>&copy; 2025 Ù‚ÙˆØ© Ø¹Ù…Ù„ Ø§Ù„Ù†ÙŠÙ„. Ù…Ø±ÙƒØ² Ø¹Ù„Ù‰ Ù…ØµØ±. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        /***************************
         *  CONFIG - Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§
         ***************************/
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        // UID of the Firebase user that is the real admin (set after creating the admin user in Firebase Auth)
        const ADMIN_UID = "PUT_ADMIN_UID_HERE"; // Ø¶Ø¹ uid Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù…

        // Local owner password (used only to reveal the admin link on your device) - ØºÙŠÙ‘Ø±Ù‡ Ù„ÙƒÙ„Ù…Ø© Ø³Ø± Ù‚ÙˆÙŠØ©
        const OWNER_PASSWORD = "change_this_owner_password";

        /***************************
         *  INIT Firebase (compat)
         ***************************/
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // UI helpers
        function showSection(id) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            window.scrollTo({top:0,behavior:'smooth'});
        }

        // Language helper (kept simple)
        function changeLanguage(lang) {
            if (lang === 'en') {
                document.documentElement.lang = 'en'; document.body.dir = 'ltr';
                document.getElementById('bootstrap-css').href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css';
            } else {
                document.documentElement.lang = 'ar'; document.body.dir = 'rtl';
                document.getElementById('bootstrap-css').href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css';
            }
        }

        // Show admin nav if local owner flag set or if logged-in admin
        function updateAdminNavVisibility() {
            const nav = document.getElementById('adminNav');
            const isOwner = localStorage.getItem('isOwner') === 'true';
            if (isOwner) nav.classList.remove('hidden'); else nav.classList.add('hidden');
        }

        // Unlock admin link locally (client-side) - set your OWNER_PASSWORD above
        function unlockAdmin() {
            const p = prompt('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø±Ù‡Ø§ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²:');
            if (!p) return;
            if (p === OWNER_PASSWORD) {
                localStorage.setItem('isOwner','true');
                updateAdminNavVisibility();
                alert('ØªÙ… Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø². Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Firebase Auth.');
            } else alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
        }

        // Application form handling with resume upload to Firebase Storage
        document.getElementById('applicationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const job = document.getElementById('job').value.trim();
            const resumeLink = document.getElementById('resumeLink').value.trim();
            const resumeFile = document.getElementById('resumeFile').files[0];
            const statusEl = document.getElementById('uploadStatus');

            try {
                statusEl.textContent = 'Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...';
                let resumeUrl = '';
                let resumeName = '';
                if (resumeFile) {
                    const ext = resumeFile.name.split('.').pop();
                    const time = Date.now();
                    const storageRef = storage.ref().child(`resumes/${time}_${name.replace(/\s+/g,'_')}.${ext}`);
                    const uploadTask = await storageRef.put(resumeFile);
                    resumeUrl = await uploadTask.ref.getDownloadURL();
                    resumeName = resumeFile.name;
                } else if (resumeLink) {
                    resumeUrl = resumeLink;
                    resumeName = 'link';
                }

                await db.collection('applications').add({
                    name, email, phone: phone || null, job, resumeUrl: resumeUrl || null, resumeName: resumeName || null, timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                statusEl.textContent = 'ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­.';
                document.getElementById('applicationForm').reset();
                setTimeout(()=> statusEl.textContent = '', 3000);
                showSection('home');
            } catch (err) {
                statusEl.textContent = 'Ø®Ø·Ø£: ' + err.message;
            }
        });

        document.getElementById('clearForm').addEventListener('click', ()=> document.getElementById('applicationForm').reset());

        /*******************
         *  ADMIN functions
         *******************/
        async function adminLogin() {
            const email = document.getElementById('adminEmail').value.trim();
            const password = document.getElementById('adminPassword').value;
            try {
                const res = await auth.signInWithEmailAndPassword(email, password);
                const uid = res.user.uid;
                if (uid !== ADMIN_UID) {
                    await auth.signOut();
                    alert('Ù…Ø³ØªØ®Ø¯Ù… ØµØ§Ù„Ø­ Ù„ÙƒÙ† Ù„ÙŠØ³ Ù‡Ùˆ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„. ØªØ£ÙƒØ¯ Ù…Ù† ADMIN_UID ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.');
                    return;
                }
                // show panel
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('applicantsPanel').classList.remove('hidden');
                localStorage.setItem('isOwner','true');
                updateAdminNavVisibility();
                loadApplicants();
            } catch (err) {
                alert('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + err.message);
            }
        }

        function adminLogout() {
            auth.signOut();
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('applicantsPanel').classList.add('hidden');
        }

        // Load applicants into table
        async function loadApplicants() {
            const tbody = document.getElementById('applicantsTableBody');
            tbody.innerHTML = '';
            try {
                const snapshot = await db.collection('applications').orderBy('timestamp','desc').get();
                snapshot.forEach(doc => {
                    const d = doc.data();
                    const time = d.timestamp ? d.timestamp.toDate().toLocaleString() : 'N/A';
                    const resumeCell = d.resumeUrl ? `<a href="${d.resumeUrl}" target="_blank">Ø¹Ø±Ø¶</a>` : 'N/A';
                    const row = `<tr>
                        <td>${escapeHtml(d.name)}</td>
                        <td>${escapeHtml(d.email)}</td>
                        <td>${escapeHtml(d.phone || 'N/A')}</td>
                        <td>${resumeCell}</td>
                        <td>${escapeHtml(d.job)}</td>
                        <td>${time}</td>
                    </tr>`;
                    tbody.innerHTML += row;
                });
            } catch (err) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†: ' + err.message);
            }
        }

        // Export applicants as CSV
        async function exportCSV() {
            try {
                const snapshot = await db.collection('applications').orderBy('timestamp','desc').get();
                const rows = [['name','email','phone','job','resumeUrl','resumeName','timestamp']];
                snapshot.forEach(doc=>{
                    const d = doc.data();
                    const ts = d.timestamp ? d.timestamp.toDate().toISOString() : '';
                    rows.push([d.name||'', d.email||'', d.phone||'', d.job||'', d.resumeUrl||'', d.resumeName||'', ts]);
                });
                const csv = rows.map(r => r.map(cell=>`"${String(cell||'').replace(/"/g,'""')}"`).join(',')).join('\n');
                const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a'); a.href = url; a.download = 'applicants.csv'; document.body.appendChild(a); a.click(); a.remove();
                URL.revokeObjectURL(url);
            } catch (err) { alert('Failed to export: ' + err.message); }
        }

        // Import CSV (admin only) - expects header row with at least name,email,job
        async function importCSVFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (!confirm('Ø³ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù…Ù† Ù…Ù„Ù CSV Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© applications. Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')) return;
            const text = await file.text();
            const lines = text.split(/\r?\n/).filter(l=>l.trim());
            const header = lines.shift().split(',').map(h=>h.replace(/\"/g,'').trim().toLowerCase());
            const idx = (col)=> header.indexOf(col);
            const batch = db.batch ? db.batch() : null; // compat
            try {
                for (const line of lines) {
                    const cols = parseCSVLine(line);
                    const docObj = {
                        name: cols[idx('name')] || cols[idx('full name')] || '',
                        email: cols[idx('email')] || '',
                        phone: cols[idx('phone')] || null,
                        job: cols[idx('job')] || '',
                        resumeUrl: cols[idx('resumeurl')] || cols[idx('resume_url')] || null,
                        resumeName: cols[idx('resumename')] || null,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    await db.collection('applications').add(docObj);
                }
                alert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
                loadApplicants();
            } catch (err) { alert('Ø®Ø·Ø£ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: ' + err.message); }
        }

        // Utilities
        function escapeHtml(text){ if(!text) return ''; return String(text).replace(/[&<>"'`]/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','`':'&#96;'})[s]); }
        function parseCSVLine(line){ // simple CSV parser that handles quoted values
            const res=[]; let cur=''; let inQuotes=false; for(let i=0;i<line.length;i++){ const ch=line[i]; if(ch==='"'){ if(inQuotes && line[i+1]==='"'){ cur+='"'; i++; } else inQuotes=!inQuotes; } else if(ch===',' && !inQuotes){ res.push(cur); cur=''; } else cur+=ch; } res.push(cur); return res.map(s=>s.replace(/^"|"$/g,'')); }

        // On load
        window.addEventListener('DOMContentLoaded', ()=>{
            // populate some static jobs (or you can fetch from DB)
            const jobsList = document.getElementById('jobsList');
            const jobs = [
                {title:'Ù…Ø¯ÙŠØ± ÙÙ†Ø¯Ù‚ - Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙ†Ø§Ø¯Ù‚ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©', desc:'Ø§Ù„Ù‚Ø·Ø§Ø¹: Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ | Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© | 5+ Ø³Ù†ÙˆØ§Øª'},
                {title:'Ù…Ù†Ø³Ù‚ Ù…Ù†ØªØ¬Ø¹ - Ù…Ù†ØªØ¬Ø¹Ø§Øª Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®', desc:'Ø§Ù„Ù‚Ø·Ø§Ø¹: Ø§Ù„Ù…Ù†ØªØ¬Ø¹Ø§Øª | Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®'},
                {title:'Ù…Ø´Ø±Ù Ù…ØµÙ†Ø¹ - ØªØµÙ†ÙŠØ¹ Ø§Ù„Ù†ÙŠÙ„', desc:'Ø§Ù„Ù‚Ø·Ø§Ø¹: Ø§Ù„Ù…ØµØ§Ù†Ø¹ | Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©'},
                {title:'Ù…Ø­Ù„Ù„ Ø´Ø±ÙƒØ§Øª - Ø´Ø±ÙƒØ© Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…ØµØ±ÙŠØ©', desc:'Ø§Ù„Ù‚Ø·Ø§Ø¹: Ø§Ù„Ø´Ø±ÙƒØ§Øª | Ø§Ù„Ø¬ÙŠØ²Ø©'}
            ];
            jobs.forEach(j=>{
                const col = document.createElement('div'); col.className='col-md-6 col-lg-4';
                col.innerHTML = `<div class="card job-card"><div class="card-body"><h5 class="card-title">${escapeHtml(j.title)}</h5><p class="card-text">${escapeHtml(j.desc)}</p><button class="btn btn-primary" onclick="showApplyFromCard('${escapeHtml(j.title)}')">ØªÙ‚Ø¯Ù…</button></div></div>`;
                jobsList.appendChild(col);
            });

            // admin nav visibility from local storage
            updateAdminNavVisibility();

            // if owner is set, show admin panel link automatically
            const isOwner = localStorage.getItem('isOwner') === 'true';
            if (isOwner) document.getElementById('adminNav').classList.remove('hidden');

            // if already logged in and is admin, show panel
            auth.onAuthStateChanged(user => {
                if (user && user.uid === ADMIN_UID) {
                    document.getElementById('loginForm').style.display='none';
                    document.getElementById('applicantsPanel').classList.remove('hidden');
                    document.getElementById('adminNav').classList.remove('hidden');
                    loadApplicants();
                }
            });

            showSection('home');
        });

        function showApplyFromCard(title){ showSection('apply'); document.getElementById('job').value = title; }
    </script>
</body>
</html>
