<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nile workforce | توظيف فنادق ومصانع وشركات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ====== جميع الأنماط السابقة تبقى كما هي ====== */
        :root {
            --primary: #0f3b5c;
            --secondary: #1e88e5;
            --accent: #ff9800;
            --success: #4CAF50;
            --danger: #f44336;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --border-radius: 12px;
            --shadow: 0 5px 15px rgba(0,0,0,0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .section {
            padding: 80px 0;
        }
        
        /* ... باقي الأنماط كما هي بدون تغيير ... */
        
        /* أضف هذا النمط الجديد */
        .debug-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            z-index: 9999;
            display: none;
        }
    </style>
</head>
<body>
    <!-- زر واتساب عائم -->
    <a href="https://wa.me/201028052445" target="_blank" class="whatsapp-float">
        <i class="fab fa-whatsapp"></i>
    </a>
    
    <!-- زر لوحة التحكم العائم -->
    <div class="admin-float" id="adminToggle" title="لوحة التحكم">
        <i class="fas fa-chart-line"></i>
    </div>
    
    <!-- معلومات تصحيح (للمطور فقط) -->
    <div class="debug-info" id="debugInfo"></div>
    
    <!-- الهيدر -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <div class="logo-text">
                        <h1>نيل ورك فورس</h1>
                        <p>توظيف الفنادق والمصانع والشركات في مصر</p>
                    </div>
                </div>
                
                <nav>
                    <ul class="nav-links">
                        <li><a href="#home">الرئيسية</a></li>
                        <li><a href="#sectors">القطاعات</a></li>
                        <li><a href="#application">التقديم للوظائف</a></li>
                        <li><a href="#contact">اتصل بنا</a></li>
                        <li><span class="contact-header"><i class="fas fa-phone"></i> 201028052445+</span></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    
    <!-- قسم الهيرو -->
    <section class="hero" id="home">
        <div class="container">
            <h1>توظيف احترافي للفنادق والمصانع والشركات</h1>
            <p>نوفر لك أفضل الكوادر المؤهلة والمدربة للعمل في جميع محافظات مصر. قدم سيرتك الذاتية الآن ووفر وقتك وجهدك في عملية التوظيف.</p>
            <div class="hero-btns">
                <a href="#application" class="btn btn-primary">قدم على وظيفة الآن</a>
                <a href="#contact" class="btn btn-outline">التوظيف لدى شركتك</a>
            </div>
        </div>
    </section>
    
    <!-- قسم الإحصائيات -->
    <section class="section">
        <div class="container">
            <h2 style="text-align: center;">أرقام تبرز ثقتنا</h2>
            <p style="text-align: center; color: var(--gray); margin-bottom: 30px;">نعمل باحترافية لنكون شريكك الموثوق في توظيف العمالة في مصر</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-hotel"></i>
                    </div>
                    <span class="stat-number" id="statHotels">500+</span>
                    <span class="stat-text">فندق ومنتجع</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-industry"></i>
                    </div>
                    <span class="stat-number" id="statFactories">300+</span>
                    <span class="stat-text">مصنع وشركة</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <span class="stat-number" id="statApplicants">10,000+</span>
                    <span class="stat-text">باحث عن عمل</span>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <span class="stat-number" id="statGovernorates">27</span>
                    <span class="stat-text">محافظة مصرية</span>
                </div>
            </div>
        </div>
    </section>
    
    <!-- قسم القطاعات -->
    <section class="section" id="sectors" style="background: var(--light);">
        <div class="container">
            <h2 style="text-align: center;">القطاعات المتخصصة</h2>
            <p style="text-align: center; color: var(--gray); margin-bottom: 30px;">نوفر عمالة مؤهلة ومتدربة في جميع التخصصات</p>
            
            <div class="sectors-grid">
                <!-- قطاع الفنادق -->
                <div class="sector-card">
                    <div class="sector-img">
                        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=700&q=80" alt="الفنادق والمنتجعات">
                    </div>
                    <div class="sector-content">
                        <h3>الفنادق والمنتجعات</h3>
                        <p style="margin-bottom: 20px; color: var(--gray);">إدارة، مطاعم، خدمات غرف، استقبال، طهاة، نظافة، أمن، وجميع التخصصات الفندقية.</p>
                        <a href="#application" class="btn btn-primary" style="width: 100%;">التوظيف في هذا القطاع</a>
                    </div>
                </div>
                
                <!-- قطاع المصانع -->
                <div class="sector-card">
                    <div class="sector-img">
                        <img src="https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=700&q=80" alt="المصانع والصناعات">
                    </div>
                    <div class="sector-content">
                        <h3>المصانع والصناعات</h3>
                        <p style="margin-bottom: 20px; color: var(--gray);">إنتاج، جودة، صيانة، تشغيل، لوجستيات، تخزين، وجميع الوظائف الصناعية.</p>
                        <a href="#application" class="btn btn-primary" style="width: 100%;">التوظيف في هذا القطاع</a>
                    </div>
                </div>
                
                <!-- قطاع الشركات -->
                <div class="sector-card">
                    <div class="sector-img">
                        <img src="https://images.unsplash.com/photo-1542744095-fcf48d80b0fd?ixlib=rb-4.0.3&auto=format&fit=crop&w=700&q=80" alt="الشركات والمؤسسات">
                    </div>
                    <div class="sector-content">
                        <h3>الشركات والمؤسسات</h3>
                        <p style="margin-bottom: 20px; color: var(--gray);">محاسبة، مبيعات، تسويق، خدمة عملاء، موارد بشرية، تكنولوجيا، وإداريين.</p>
                        <a href="#application" class="btn btn-primary" style="width: 100%;">التوظيف في هذا القطاع</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- قسم نموذج التقديم -->
    <section class="section form-section" id="application">
        <div class="container">
            <h2 class="form-title">نموذج التقدم للوظائف</h2>
            <p class="form-subtitle">املأ النموذج أدناه مع إرفاق سيرتك الذاتية وسنتواصل معك في أقرب وقت</p>
            
            <div class="form-container">
                <form id="jobApplicationForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fullName">الاسم بالكامل *</label>
                            <input type="text" id="fullName" name="fullName" required placeholder="أدخل اسمك الثلاثي">
                        </div>
                        
                        <div class="form-group">
                            <label for="phone">رقم الهاتف *</label>
                            <input type="tel" id="phone" name="phone" required placeholder="+201028052445">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">البريد الإلكتروني *</label>
                            <input type="email" id="email" name="email" required placeholder="example@domain.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="governorate">المحافظة *</label>
                            <select id="governorate" name="governorate" required>
                                <option value="">اختر محافظتك</option>
                                <option value="القاهرة">القاهرة</option>
                                <option value="الجيزة">الجيزة</option>
                                <option value="الإسكندرية">الإسكندرية</option>
                                <option value="الشرقية">الشرقية</option>
                                <option value="الدقهلية">الدقهلية</option>
                                <option value="أخرى">محافظة أخرى</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="sector">القطاع المرغوب *</label>
                        <select id="sector" name="sector" required>
                            <option value="">اختر القطاع الذي ترغب العمل به</option>
                            <option value="الفنادق والمنتجعات">الفنادق والمنتجعات</option>
                            <option value="المصانع والصناعات">المصانع والصناعات</option>
                            <option value="الشركات والمؤسسات">الشركات والمؤسسات</option>
                            <option value="أي قطاع متاح">أي قطاع متاح</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="experience">الخبرة (سنوات) *</label>
                        <select id="experience" name="experience" required>
                            <option value="">حدد سنوات خبرتك</option>
                            <option value="بدون خبرة">بدون خبرة</option>
                            <option value="1-3 سنوات">من سنة إلى 3 سنوات</option>
                            <option value="3-5 سنوات">من 3 إلى 5 سنوات</option>
                            <option value="أكثر من 5 سنوات">أكثر من 5 سنوات</option>
                        </select>
                    </div>
                    
                    <!-- حقل رفع السيرة الذاتية -->
                    <div class="form-group">
                        <label for="cv">السيرة الذاتية (PDF أو Word) *</label>
                        <div class="file-upload" id="fileUploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span id="fileUploadText">انقر لرفع السيرة الذاتية</span>
                            <p style="margin-top: 10px; font-size: 0.9rem; color: var(--gray);">المسموح: PDF, DOC, DOCX (الحد الأقصى: 5MB)</p>
                            <input type="file" id="cv" name="cv" accept=".pdf,.doc,.docx" required>
                        </div>
                        <div id="fileName" class="file-name"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="message">ملاحظات إضافية (اختياري)</label>
                        <textarea id="message" name="message" rows="4" placeholder="أي معلومات إضافية تود إضافتها عن مؤهلاتك أو طلباتك..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-submit">
                        <i class="fas fa-paper-plane"></i> إرسال الطلب
                    </button>
                </form>
                
                <!-- رسالة النجاح -->
                <div id="formMessage" class="message"></div>
            </div>
            
            <!-- لوحة التحكم المدمجة -->
            <div class="dashboard-section" id="dashboard">
                <div class="dashboard-header">
                    <h2 style="color: var(--primary);">
                        <i class="fas fa-chart-line"></i> لوحة تحكم المشرف
                    </h2>
                    <div>
                        <button class="btn btn-primary" onclick="exportData()">
                            <i class="fas fa-download"></i> تصدير البيانات
                        </button>
                        <button class="btn btn-danger" onclick="clearAllData()">
                            <i class="fas fa-trash"></i> مسح الكل
                        </button>
                        <button class="btn" onclick="refreshDashboard()" style="background: var(--accent); color: white;">
                            <i class="fas fa-sync-alt"></i> تحديث
                        </button>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px; text-align: center;">
                    <span id="applicationsCount" style="background: var(--secondary); color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                        0 طلبات
                    </span>
                </div>
                
                <div class="dashboard-stats" id="dashboardStats">
                    <!-- سيتم تعبئتها بالجافاسكريبت -->
                </div>
                
                <div style="overflow-x: auto; margin-top: 30px;">
                    <table class="applications-table" id="applicationsTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>الاسم</th>
                                <th>الهاتف</th>
                                <th>المحافظة</th>
                                <th>القطاع</th>
                                <th>الخبرة</th>
                                <th>التاريخ</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="applicationsBody">
                            <!-- سيتم تعبئتها بالجافاسكريبت -->
                        </tbody>
                    </table>
                </div>
                
                <div style="text-align: center; margin-top: 20px; color: var(--gray); font-size: 0.9rem;">
                    <p id="lastUpdate">آخر تحديث: --</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- باقي أقسام الموقع تبقى كما هي -->
    
    <script>
        // ====== المتغيرات العامة ======
        const STORAGE_KEY = 'nileWorkforceApplications';
        const ADMIN_PASSWORD = "admin123";
        
        // ====== تهيئة الصفحة ======
        document.addEventListener('DOMContentLoaded', function() {
            console.log('تم تحميل الصفحة، جاري تهيئة النظام...');
            
            // تفعيل رفع الملفات
            document.getElementById('fileUploadArea').addEventListener('click', function() {
                document.getElementById('cv').click();
            });
            
            document.getElementById('cv').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const uploadText = document.getElementById('fileUploadText');
                const fileName = document.getElementById('fileName');
                
                if (file) {
                    // التحقق من حجم الملف (5MB كحد أقصى)
                    if (file.size > 5 * 1024 * 1024) {
                        alert('حجم الملف كبير جدًا. الحد الأقصى المسموح به هو 5MB.');
                        e.target.value = '';
                        uploadText.textContent = 'انقر لرفع السيرة الذاتية';
                        fileName.textContent = '';
                        return;
                    }
                    
                    // التحقق من نوع الملف
                    const allowedTypes = ['.pdf', '.doc', '.docx'];
                    const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                    
                    if (!allowedTypes.includes(fileExtension)) {
                        alert('نوع الملف غير مدعوم. يرجى رفع ملف PDF أو Word.');
                        e.target.value = '';
                        uploadText.textContent = 'انقر لرفع السيرة الذاتية';
                        fileName.textContent = '';
                        return;
                    }
                    
                    uploadText.textContent = 'تم اختيار الملف';
                    fileName.innerHTML = `<i class="fas fa-check-circle"></i> ${file.name} (${formatFileSize(file.size)})`;
                    document.getElementById('fileUploadArea').style.borderColor = '#4CAF50';
                    document.getElementById('fileUploadArea').style.background = '#f0f9f0';
                }
            });
            
            // زر عرض/إخفاء لوحة التحكم
            document.getElementById('adminToggle').addEventListener('click', function() {
                showDashboard();
            });
            
            // التمرير السلس للروابط
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // تحديث الإحصائيات
            updateAllStats();
            
            console.log('التهيئة اكتملت.');
        });
        
        // ====== عرض لوحة التحكم ======
        function showDashboard() {
            const password = prompt('أدخل كلمة المرور للوصول إلى لوحة التحكم:');
            if (password === ADMIN_PASSWORD) {
                const dashboard = document.getElementById('dashboard');
                dashboard.style.display = 'block';
                
                // تحميل البيانات وعرضها
                loadDashboardData();
                
                // التمرير إلى لوحة التحكم
                dashboard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else if (password !== null) {
                alert('كلمة المرور غير صحيحة');
            }
        }
        
        // ====== تحميل بيانات لوحة التحكم ======
        function loadDashboardData() {
            console.log('جاري تحميل بيانات لوحة التحكم...');
            
            // جلب البيانات من localStorage
            const applications = getApplications();
            
            // تحديث عدد الطلبات
            document.getElementById('applicationsCount').textContent = `${applications.length} طلبات`;
            
            // تحديث الإحصائيات
            updateDashboardStats(applications);
            
            // تحديث الجدول
            updateApplicationsTable(applications);
            
            // تحديث وقت آخر تحديث
            document.getElementById('lastUpdate').textContent = `آخر تحديث: ${new Date().toLocaleString('ar-EG')}`;
            
            console.log(`تم تحميل ${applications.length} طلبات`);
        }
        
        // ====== جلب التطبيقات من localStorage ======
        function getApplications() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                if (!data) return [];
                
                const applications = JSON.parse(data);
                console.log(`تم جلب ${applications.length} طلب من التخزين`);
                return Array.isArray(applications) ? applications : [];
            } catch (error) {
                console.error('خطأ في جلب البيانات:', error);
                return [];
            }
        }
        
        // ====== حفظ التطبيقات في localStorage ======
        function saveApplications(applications) {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(applications));
                console.log(`تم حفظ ${applications.length} طلب في التخزين`);
                return true;
            } catch (error) {
                console.error('خطأ في حفظ البيانات:', error);
                alert('حدث خطأ في حفظ البيانات. قد يكون التخزين ممتلئًا.');
                return false;
            }
        }
        
        // ====== معالجة نموذج التقديم ======
        document.getElementById('jobApplicationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // التحقق من رفع الملف
            const cvFile = document.getElementById('cv').files[0];
            if (!cvFile) {
                showMessage('يرجى رفع السيرة الذاتية', 'error');
                return;
            }
            
            // جمع بيانات النموذج
            const application = {
                id: Date.now() + Math.random().toString(36).substr(2, 9),
                name: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                governorate: document.getElementById('governorate').value,
                sector: document.getElementById('sector').value,
                experience: document.getElementById('experience').value,
                cvFile: {
                    name: cvFile.name,
                    size: cvFile.size,
                    type: cvFile.type,
                },
                message: document.getElementById('message').value || 'لا يوجد',
                date: new Date().toLocaleString('ar-EG'),
                timestamp: Date.now()
            };
            
            console.log('طلب جديد:', application);
            
            // جلب التطبيقات الحالية
            let applications = getApplications();
            
            // إضافة الطلب الجديد
            applications.unshift(application);
            
            // حفظ في localStorage
            if (saveApplications(applications)) {
                // عرض رسالة النجاح
                const referenceNumber = 'NW-' + application.id.toString().slice(-6);
                showMessage(`
                    <h3><i class="fas fa-check-circle"></i> تم إرسال طلبك بنجاح!</h3>
                    <p>رقم المرجع: <strong>${referenceNumber}</strong></p>
                    <p>شكرًا لك <strong>${application.name}</strong> على تقديم طلبك.</p>
                    <p>سنتواصل معك على الرقم <strong>${application.phone}</strong> في غضون 48 ساعة عمل.</p>
                    <p><small>تم حفظ الطلب رقم ${applications.length} في النظام</small></p>
                `, 'success');
                
                // تحديث الإحصائيات
                updateAllStats();
                
                // إذا كانت لوحة التحكم مفتوحة، قم بتحديثها
                if (document.getElementById('dashboard').style.display === 'block') {
                    loadDashboardData();
                }
                
                // مسح النموذج بعد 5 ثوانٍ
                setTimeout(() => {
                    document.getElementById('jobApplicationForm').reset();
                    document.getElementById('fileUploadText').textContent = 'انقر لرفع السيرة الذاتية';
                    document.getElementById('fileName').textContent = '';
                    document.getElementById('fileUploadArea').style.borderColor = '#ddd';
                    document.getElementById('fileUploadArea').style.background = '#f8f9fa';
                    document.getElementById('formMessage').style.display = 'none';
                }, 8000);
            } else {
                showMessage('حدث خطأ في حفظ البيانات. يرجى المحاولة مرة أخرى.', 'error');
            }
        });
        
        // ====== تحديث الإحصائيات ======
        function updateAllStats() {
            const applications = getApplications();
            
            // تحديث الإحصائيات العامة
            document.getElementById('statHotels').textContent = `${applications.filter(app => app.sector.includes('فندق')).length}+`;
            document.getElementById('statFactories').textContent = `${applications.filter(app => app.sector.includes('مصنع')).length}+`;
            document.getElementById('statApplicants').textContent = `${applications.length}+`;
            document.getElementById('statGovernorates').textContent = new Set(applications.map(app => app.governorate)).size;
        }
        
        function updateDashboardStats(applications) {
            const today = new Date().toDateString();
            const todayApps = applications.filter(app => 
                new Date(app.timestamp).toDateString() === today
            ).length;
            
            const hotelApps = applications.filter(app => app.sector.includes('فندق')).length;
            const factoryApps = applications.filter(app => app.sector.includes('مصنع')).length;
            const companyApps = applications.filter(app => app.sector.includes('شركات')).length;
            
            const statsHTML = `
                <div class="dashboard-stat">
                    <h3>${applications.length}</h3>
                    <p>إجمالي الطلبات</p>
                </div>
                <div class="dashboard-stat">
                    <h3>${todayApps}</h3>
                    <p>طلبات اليوم</p>
                </div>
                <div class="dashboard-stat">
                    <h3>${hotelApps}</h3>
                    <p>طلبات الفنادق</p>
                </div>
                <div class="dashboard-stat">
                    <h3>${factoryApps}</h3>
                    <p>طلبات المصانع</p>
                </div>
                <div class="dashboard-stat">
                    <h3>${companyApps}</h3>
                    <p>طلبات الشركات</p>
                </div>
            `;
            
            document.getElementById('dashboardStats').innerHTML = statsHTML;
        }
        
        // ====== تحديث جدول الطلبات ======
        function updateApplicationsTable(applications) {
            const tbody = document.getElementById('applicationsBody');
            
            if (applications.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px; display: block; opacity: 0.5;"></i>
                            لا توجد طلبات توظيف بعد
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            applications.forEach((app, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <strong>${app.name}</strong><br>
                            <small>${app.email}</small>
                        </td>
                        <td>${app.phone}</td>
                        <td>${app.governorate}</td>
                        <td><span style="background: #e8f0fe; padding: 4px 10px; border-radius: 4px;">${app.sector}</span></td>
                        <td>${app.experience}</td>
                        <td><small>${app.date}</small></td>
                        <td>
                            <div class="action-btns">
                                <button class="btn btn-primary" onclick="viewApplicationDetails('${app.id}')" style="padding: 8px 12px;">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-success" onclick="contactApplicant('${app.phone}', '${app.name}')" style="padding: 8px 12px;">
                                    <i class="fab fa-whatsapp"></i>
                                </button>
                                <button class="btn btn-danger" onclick="deleteApplication('${app.id}')" style="padding: 8px 12px;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // ====== عرض تفاصيل الطلب ======
        function viewApplicationDetails(id) {
            const applications = getApplications();
            const application = applications.find(app => app.id === id);
            
            if (!application) {
                alert('الطلب غير موجود');
                return;
            }
            
            // عرض التفاصيل في نافذة منبثقة
            const details = `
                <h3 style="color: var(--primary);">تفاصيل طلب التوظيف</h3>
                <div style="margin-top: 20px;">
                    <p><strong>الاسم:</strong> ${application.name}</p>
                    <p><strong>الهاتف:</strong> ${application.phone}</p>
                    <p><strong>البريد الإلكتروني:</strong> ${application.email}</p>
                    <p><strong>المحافظة:</strong> ${application.governorate}</p>
                    <p><strong>القطاع:</strong> ${application.sector}</p>
                    <p><strong>الخبرة:</strong> ${application.experience}</p>
                    <p><strong>تاريخ التقديم:</strong> ${application.date}</p>
                    <p><strong>السيرة الذاتية:</strong> ${application.cvFile.name} (${formatFileSize(application.cvFile.size)})</p>
                    ${application.message !== 'لا يوجد' ? `<p><strong>الملاحظات:</strong> ${application.message}</p>` : ''}
                </div>
            `;
            
            alert(details);
        }
        
        // ====== التواصل مع المتقدم ======
        function contactApplicant(phone, name) {
            const message = `مرحبًا ${name}، شكرًا لتقديمك على موقع نيل ورك فورس. نود التواصل معك بخصوص طلب التوظيف.`;
            const whatsappUrl = `https://wa.me/${phone.replace('+', '')}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
        
        // ====== حذف الطلب ======
        function deleteApplication(id) {
            if (!confirm('هل أنت متأكد من حذف هذا الطلب؟')) {
                return;
            }
            
            let applications = getApplications();
            applications = applications.filter(app => app.id !== id);
            
            if (saveApplications(applications)) {
                alert('تم حذف الطلب بنجاح');
                loadDashboardData();
                updateAllStats();
            } else {
                alert('حدث خطأ في حذف البيانات');
            }
        }
        
        // ====== تصدير البيانات ======
        function exportData() {
            const applications = getApplications();
            
            if (applications.length === 0) {
                alert('لا توجد بيانات للتصدير');
                return;
            }
            
            let csv = 'الاسم,الهاتف,البريد الإلكتروني,المحافظة,القطاع,الخبرة,التاريخ,الملاحظات\n';
            
            applications.forEach(app => {
                const row = [
                    `"${app.name}"`,
                    `"${app.phone}"`,
                    `"${app.email}"`,
                    `"${app.governorate}"`,
                    `"${app.sector}"`,
                    `"${app.experience}"`,
                    `"${app.date}"`,
                    `"${app.message}"`
                ].join(',');
                
                csv += row + '\n';
            });
            
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `طلبات_التوظيف_${new Date().toISOString().slice(0,10)}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert(`تم تصدير ${applications.length} طلب بنجاح`);
        }
        
        // ====== مسح جميع البيانات ======
        function clearAllData() {
            if (!confirm('هل أنت متأكد من مسح جميع البيانات؟ هذا الإجراء لا يمكن التراجع عنه.')) {
                return;
            }
            
            if (confirm('⚠️ تأكيد نهائي: هل أنت متأكد تمامًا من مسح جميع طلبات التوظيف؟')) {
                localStorage.removeItem(STORAGE_KEY);
                alert('تم مسح جميع البيانات بنجاح');
                loadDashboardData();
                updateAllStats();
            }
        }
        
        // ====== تحديث لوحة التحكم ======
        function refreshDashboard() {
            loadDashboardData();
            alert('تم تحديث البيانات');
        }
        
        // ====== وظائف مساعدة ======
        function showMessage(content, type) {
            const messageDiv = document.getElementById('formMessage');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = content;
            messageDiv.style.display = 'block';
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' بايت';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' كيلوبايت';
            else return (bytes / 1048576).toFixed(1) + ' ميجابايت';
        }
        
        // ====== اختبار النظام ======
        function testSystem() {
            console.log('=== اختبار النظام ===');
            console.log('1. جلب البيانات:', getApplications().length, 'طلبات');
            console.log('2. تخزين اختباري...');
            
            const testApp = {
                id: 'test-' + Date.now(),
                name: 'اختبار النظام',
                phone: '+20123456789',
                email: 'test@example.com',
                governorate: 'القاهرة',
                sector: 'الفنادق والمنتجعات',
                experience: '1-3 سنوات',
                cvFile: { name: 'test.pdf', size: 1024, type: 'application/pdf' },
                message: 'هذا طلب اختباري',
                date: new Date().toLocaleString('ar-EG'),
                timestamp: Date.now()
            };
            
            let apps = getApplications();
            apps.unshift(testApp);
            saveApplications(apps);
            
            console.log('3. بعد الإضافة:', getApplications().length, 'طلبات');
            console.log('4. حذف الاختبار...');
            
            apps = apps.filter(app => !app.id.includes('test-'));
            saveApplications(apps);
            
            console.log('5. بعد الحذف:', getApplications().length, 'طلبات');
            console.log('=== انتهاء الاختبار ===');
        }
        
        // تشغيل اختبار النظام عند تحميل الصفحة (للمطور فقط)
        // testSystem();
    </script>
</body>
</html>
